# OUCH Initiator Configuration
# Supports both OUCH 4.2 and 5.0 protocols

# Component definitions - processed in dependency order
components {
    clock-provider {
        enabled = true
        factory = "com.omnibridge.config.factory.ClockProviderFactory"
        type = "com.omnibridge.config.ClockProvider"
    }

    network {
        enabled = true
        factory = "com.omnibridge.network.factory.NetworkEventLoopFactory"
        type = "com.omnibridge.network.NetworkEventLoop"
        dependencies = ["clock-provider"]
    }

    session-management {
        enabled = true
        factory = "com.omnibridge.config.factory.SessionManagementServiceFactory"
        type = "com.omnibridge.config.session.SessionManagementService"
    }

    ouch-engine {
        enabled = true
        factory = "com.omnibridge.ouch.engine.factory.OuchEngineFactory"
        type = "com.omnibridge.ouch.engine.OuchEngine"
        dependencies = ["network", "clock-provider", "session-management"]
    }

    admin-server {
        enabled = true
        factory = "com.omnibridge.admin.factory.AdminServerFactory"
        type = "com.omnibridge.admin.AdminServer"
        dependencies = ["session-management"]
    }
}

# Network configuration (used by NetworkEventLoopFactory)
network {
    name = "ouch-initiator-network"
    cpu-affinity = -1
    read-buffer-size = 65536
    write-buffer-size = 65536
    select-timeout-ms = 100
    busy-spin-mode = false
}

# Admin API configuration
admin {
  enabled = true
  host = "0.0.0.0"
  port = 8082
  context-path = "/api"
  cors {
    enabled = true
    allowed-origins = ["*"]
  }
  websocket {
    enabled = true
    path = "/ws"
  }
}

ouch-engine {
    # Network configuration
    network {
        io-threads = 1
        busy-spin = false
    }

    # Session configurations
    sessions = [
        {
            session-id = "CLIENT"
            session-name = "Trading Client"
            host = "localhost"
            port = 9200
            initiator = true
            # Protocol version: "4.2" or "5.0"
            # Change to "5.0" to use OUCH 5.0 protocol
            protocol-version = "4.2"
            heartbeat-interval = 30
            reconnect-delay = 5
            max-reconnect-attempts = 3
        }
    ]
}

# Persistence (optional)
persistence {
    enabled = false
    path = "data/ouch-initiator"
}
